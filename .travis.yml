language: python
python:
    - "3.9"
install:
    - pwd
    - pip install -r requirements.txt

    # install redis
    - wget http://download.redis.io/redis-stable.tar.gz
    - tar xvzf redis-stable.tar.gz && mv redis-stable redis
    - cd redis
    - make
    - src/redis-server &
    - src/redis-cli ping
    - cd ..

    # stage 21cmSense code
    - git clone https://github.com/steven-murray/21cmSense

    # activate our virtual env - no need to do this in Travis as it's automatically done
    # - source venv/bin/activate

    # we now have our virtual env version of python
    # install py21cmsense library egg into our venv site-packages
    - cd 21cmSense && python ./setup.py install && cd ..

script: pytest
